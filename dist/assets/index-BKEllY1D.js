import*as e from"https://unpkg.com/three@0.160.0/build/three.module.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))M(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const w of c.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&M(w)}).observe(document,{childList:!0,subtree:!0});function f(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function M(a){if(a.ep)return;a.ep=!0;const c=f(a);fetch(a.href,c)}})();try{let ne=function(t,r,s){if(Math.abs(t.x)<=2&&Math.abs(t.z-8)<=2)return!1;for(let p of r)if(t.distanceTo(p.position)<s)return!1;return!0},he=function(){(o.current==="IDLE"||o.current==="MOVING")&&(d.ArrowLeft&&i.position.x>-9?o.clawVelocity.x=-o.clawSpeed:d.ArrowRight&&i.position.x<9?o.clawVelocity.x=o.clawSpeed:o.clawVelocity.x*=.9,d.ArrowUp&&i.position.z>-9?o.clawVelocity.z=-o.clawSpeed:d.ArrowDown&&i.position.z<9?o.clawVelocity.z=o.clawSpeed:o.clawVelocity.z*=.9,i.position.x+=o.clawVelocity.x,i.position.z+=o.clawVelocity.z,d[" "]&&(o.current="LOWERING",i.position.y=8,o.fingerOpen=1,o.collisionChecked=!1))},ye=function(){o.grabbedPrize||h.forEach(t=>{const r=i.position,s=t.position;Math.sqrt((r.x-s.x)**2+(r.z-s.z)**2)<1.5&&r.y<4.5&&(Math.random()<z?(o.grabbedPrize=t,i.add(t),t.position.set(0,-.75,0),console.log(`Prize grabbed successfully (${z*100}% chance)!`)):console.log(`Grab failed (${(1-z)*100}% chance).`))})},Me=function(t){return Math.abs(t.x)<2&&Math.abs(t.z-8)<2},$=function(){if(requestAnimationFrame($),he(),y.position.x=i.position.x,y.position.z=i.position.z,y.position.y=11,o.current==="LOWERING"&&(i.position.y-=o.clawSpeed,i.position.y<=4&&(o.current="GRABBING",o.grabStartTime=Date.now())),o.current==="GRABBING"){const t=Date.now()-o.grabStartTime;t<200?o.fingerOpen=1-t/200*.5:o.fingerOpen=.5,o.fingerOpen<=.5&&!o.collisionChecked&&(ye(),o.collisionChecked=!0),t>=1e3&&(o.current="RAISING")}if(o.current==="RAISING"&&(i.position.y+=o.clawSpeed,i.position.y>=8&&(o.current="DROPPING",o.targetPosition=new e.Vector3(0,8,8))),o.current==="DROPPING"&&(i.position.lerp(o.targetPosition,.1),i.position.distanceTo(o.targetPosition)<.1)){if(o.grabbedPrize){o.score+=1,console.log("Prize dropped on bin! Score: "+o.score),i.remove(o.grabbedPrize),n.remove(o.grabbedPrize);const t=h.indexOf(o.grabbedPrize);t>-1&&h.splice(t,1),o.grabbedPrize=null}o.current="IDLE",o.fingerOpen=1}o.fallingPrize&&(o.fallingVelocity+=we,o.fallingPrize.position.y-=o.fallingVelocity,o.fallingPrize.position.y<=W&&(o.fallingPrize.position.y=W,o.fallingPrize=null,o.fallingVelocity=0)),H.forEach((t,r)=>{const s=r/4*Math.PI*2;t.position.set(Math.cos(s)*o.fingerOpen,0,Math.sin(s)*o.fingerOpen)}),pe.innerHTML=`Score: ${o.score} | State: ${o.current}<br>Use Arrow Keys to move, Space to lower`,f.render(n,l)};const n=new e.Scene;n.background=new e.Color(8900331);const l=new e.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),f=new e.WebGLRenderer;f.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(f.domElement);const M=new e.AmbientLight(16777215,.5);n.add(M);const a=new e.DirectionalLight(16777215,.5);a.position.set(0,10,10),n.add(a);const c=new e.BoxGeometry(24,2,24),w=new e.MeshBasicMaterial({color:16777215}),B=new e.Mesh(c,w);B.position.y=1,n.add(B);const q=new e.CylinderGeometry(.5,.5,.5,32),F=new e.MeshBasicMaterial({color:0});for(let t=-10;t<=10;t+=20)for(let r=-10;r<=10;r+=20){const s=new e.Mesh(q,F);s.position.set(t,.25,r),n.add(s)}const u=new e.MeshBasicMaterial({color:11184810,transparent:!0,opacity:.5}),I=new e.PlaneGeometry(24,12),S=new e.Mesh(I,u);S.position.set(0,7,12),n.add(S);const m=new e.Mesh(I,u);m.position.set(0,7,-12),m.rotation.y=Math.PI,n.add(m);const O=new e.PlaneGeometry(24,12),g=new e.Mesh(O,u);g.position.set(-12,7,0),g.rotation.y=Math.PI/2,n.add(g);const b=new e.Mesh(O,u);b.position.set(12,7,0),b.rotation.y=-Math.PI/2,n.add(b);const K=new e.CylinderGeometry(.5,.5,12,32),U=new e.MeshBasicMaterial({color:12632256});for(let t=-11.5;t<=11.5;t+=23)for(let r=-11.5;r<=11.5;r+=23){const s=new e.Mesh(K,U);s.position.set(t,7,r),n.add(s)}const Y=new e.BoxGeometry(26,1,26),_=new e.MeshBasicMaterial({color:16711680}),L=new e.Mesh(Y,_);L.position.y=13,n.add(L);const j=new e.BoxGeometry(24,2,2),J=new e.MeshBasicMaterial({color:16711680}),E=new e.Mesh(j,J);E.position.set(0,2,13),n.add(E);const x=new e.SphereGeometry(.5,32,32),G=new e.MeshBasicMaterial({color:12632256}),V=new e.Mesh(x,G);V.position.set(-5,2.5,13.5),n.add(V);const A=new e.Mesh(x,G);A.position.set(0,2.5,13.5),n.add(A);const R=new e.Mesh(x,G);R.position.set(5,2.5,13.5),n.add(R);const Q=new e.CylinderGeometry(.5,.5,.5,32),X=new e.MeshBasicMaterial({color:16711680}),P=new e.Mesh(Q,X);P.position.set(8,2.25,13.5),P.rotation.x=Math.PI/2,n.add(P);const Z=new e.BoxGeometry(4,1,1),ee=new e.MeshBasicMaterial({color:16711680}),C=new e.Mesh(Z,ee);C.position.set(0,.5,13),n.add(C);const k=new e.MeshBasicMaterial({color:0}),v=new e.Mesh(new e.BoxGeometry(10,1,.1),k);v.position.set(-5,3,13.5),n.add(v);const N=new e.Mesh(new e.BoxGeometry(8,.5,.1),k);N.position.set(-4,2,13.5),n.add(N);const oe=new e.BoxGeometry(4,.5,4),te=new e.MeshBasicMaterial({color:9127187,transparent:!0,opacity:.5}),T=new e.Mesh(oe,te);T.position.set(0,2,8),n.add(T);const h=[],ie=new e.SphereGeometry(1.125,32,32),re=new e.MeshBasicMaterial({color:16729344});for(let t=0;t<10;t++){let r,s=0;do if(r=new e.Vector3((Math.random()-.5)*20,2.5,(Math.random()-.5)*20),s++,s>100){console.warn("Could not find valid position after 100 attempts.");break}while(!ne(r,h,3));if(s<=100){const p=new e.Mesh(ie,re);p.position.copy(r),n.add(p),h.push(p)}}const se=new e.CylinderGeometry(.5,.5,6,32),ae=new e.MeshBasicMaterial({color:8421504}),y=new e.Mesh(se,ae);y.position.set(0,11,0),n.add(y);const i=new e.Group,ce=new e.CylinderGeometry(.3,.3,6,32),le=new e.MeshBasicMaterial({color:255}),D=new e.Mesh(ce,le);D.position.y=3,i.add(D);const de=new e.BoxGeometry(.75,.75,.75),fe=new e.MeshBasicMaterial({color:65280}),H=[];for(let t=0;t<4;t++){const r=new e.Mesh(de,fe),s=t/4*Math.PI*2;r.position.set(Math.cos(s)*1.5,0,Math.sin(s)*1.5),i.add(r),H.push(r)}i.position.set(0,8,0),i.renderOrder=1,n.add(i),l.position.set(0,12,22),l.lookAt(0,0,0);const o={current:"IDLE",clawSpeed:.05,clawVelocity:{x:0,z:0},fingerOpen:1,grabbedPrize:null,score:0,grabStartTime:null,collisionChecked:!1,targetPosition:null,fallingPrize:null,fallingVelocity:0},pe=document.getElementById("ui"),we=.02,W=2.125,d={};window.addEventListener("keydown",t=>d[t.key]=!0),window.addEventListener("keyup",t=>d[t.key]=!1);const z=.85;$(),window.addEventListener("resize",()=>{l.aspect=window.innerWidth/window.innerHeight,l.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight)})}catch(n){console.error("Error in game setup or rendering:",n),document.body.innerHTML+=`<div style="color: red; position: absolute; top: 50px; left: 10px;">Error: ${n.message}</div>`}
